# BabyLog AI 작업 상태 (2026-02-14)

## 1. 현재까지 완료된 작업

### 1) 프로젝트 구조/스캐폴딩
- 모노레포 기본 구조 생성
  - `apps/mobile`
  - `apps/backend`
  - `packages/schema/prisma`
  - `docs/api`
  - `integrations/siri`
  - `integrations/bixby`

### 2) 모바일(Flutter) 골격
- 앱 엔트리 및 홈 탭 구조 구현
  - `apps/mobile/lib/main.dart`
  - `apps/mobile/lib/core/app.dart`
- 기능 탭 페이지 골격 생성
  - `apps/mobile/lib/features/recording/recording_page.dart`
  - `apps/mobile/lib/features/chat/chat_page.dart`
  - `apps/mobile/lib/features/report/report_page.dart`
  - `apps/mobile/lib/features/photos/photos_page.dart`
- Flutter 설정 파일 작성
  - `apps/mobile/pubspec.yaml`
  - `apps/mobile/analysis_options.yaml`
  - `apps/mobile/README.md`

### 3) 백엔드(FastAPI) 골격 + 핵심 API
- 앱 엔트리/라우터 구성
  - `apps/backend/app/main.py`
  - `apps/backend/app/api/router.py`
- 엔드포인트 초안 구현
  - 온보딩: `onboarding.py`
  - 이벤트 파싱/확정: `events.py`
  - AI 빠른 질의/일반 질의: `ai.py`
  - 리포트: `reports.py`
  - 사진 업로드 계약: `photos.py`
  - 구독: `subscription.py`
  - Siri/Bixby 어시스턴트: `assistants.py`
- ETA 계산 서비스 구현
  - `apps/backend/app/services/eta.py`
- 백엔드 실행 관련 파일 작성
  - `apps/backend/requirements.txt`
  - `apps/backend/.env.example`
  - `apps/backend/README.md`

### 4) 데이터/API 계약 문서화
- 제품/아키텍처/데이터 계약/작업 분해 문서
  - `docs/PRD.md`
  - `docs/ARCHITECTURE.md`
  - `docs/DATA_CONTRACT.md`
  - `docs/MVP_TASKS.md`
- OpenAPI 명세
  - `docs/api/openapi.yaml`

### 5) Prisma 스키마/패키지
- Prisma 스키마 작성
  - `packages/schema/prisma/schema.prisma`
- 루트 패키지 스크립트 작성
  - `package.json` (Prisma 6.16.2 고정)

### 6) Siri/Bixby 인터페이스
- Siri App Intents 인터페이스 파일
  - `integrations/siri/BabyLogAppIntents.swift`
  - `integrations/siri/README.md`
- Bixby 계약/대화 템플릿
  - `integrations/bixby/capsule_contract.json`
  - `integrations/bixby/dialog_templates.md`

## 2. 검증 결과
- Python 소스 AST 파싱 검증 통과 (`apps/backend/app` 대상)
- Prisma 스키마 검증 통과 (Prisma 6.16.2 + `DATABASE_URL` 설정 시)
- 참고: 현재 로컬 환경에 `fastapi` 패키지와 `flutter` SDK는 기본 설치되어 있지 않아 실제 런타임 실행은 미실시

## 3. 남은 핵심 작업 (다음 작업 내용)

### 우선순위 1: 백엔드 실제 영속화/보안
- FastAPI 더미 응답 -> 실제 DB 연동으로 전환
- 인증/인가(JWT + Household role 권한체크) 적용
- 이벤트/리포트/구독/사진 API의 실제 저장/조회 구현
- 감사로그(`audit_logs`) 실제 기록 구현

### 우선순위 2: 모바일-백엔드 연동
- Flutter Dio API 클라이언트 작성
- 기록/AI/리포트/사진 탭을 실제 API 호출로 연결
- 에러 처리/로딩 상태/권한 오류 UI 반영

### 우선순위 3: 음성/AI 파이프라인 고도화
- STT 연동(Provider 확정 필요)
- 이벤트 파서 정교화(복수 이벤트 + confidence 기반 수정 UX)
- RAG 컨텍스트 생성/근거 문장 강제 삽입 로직 구현
- 의료 가드레일 및 라벨링(`기록 기반` vs `일반 정보`) 고도화

### 우선순위 4: Siri/Bixby 실배포형 연동
- Siri Intent -> 앱 인증 사용자 컨텍스트 연결
- Bixby endpoint 인증/서명 검증
- 톤/페르소나 실사용자 프로필 기반 응답 일치화

### 우선순위 5: 운영 준비
- Docker compose (Postgres/Redis/API) 구성
- 테스트 코드(단위/통합) 추가
- CI 파이프라인(린트/테스트/스키마 검증) 구성

## 4. 바로 재개할 때 실행 순서
1. 백엔드 의존성 설치 후 로컬 기동
2. DB 연결/마이그레이션 적용
3. 인증/권한 미들웨어 구현
4. Flutter API 연동 시작

## 5. 참고 명령어
```bash
# backend
cd C:/Users/milkrevenant/Documents/code/babylog-ai/apps/backend
python -m venv .venv
.venv\Scripts\activate
pip install -r requirements.txt
uvicorn app.main:app --reload

# prisma
cd C:/Users/milkrevenant/Documents/code/babylog-ai
npm install
$env:DATABASE_URL="postgresql://babylog:babylog@localhost:5432/babylog"
npm run prisma:validate
npm run prisma:generate
npm run prisma:push
```

